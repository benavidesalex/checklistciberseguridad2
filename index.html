<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Checklist de Ciberseguridad Personal 2.0</title>
    <style>
        /* Estilos Base y Tipograf√≠a */
        body {
            font-family: 'Arial', sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f0f2f5;
            color: #333;
            line-height: 1.6;
        }

        .container {
            max-width: 1000px;
            margin: 0 auto;
            background-color: #FFFFFF;
            padding: 25px;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
        }

        h1 {
            color: #1A3E60;
            text-align: center;
            font-size: 2.5em;
            margin-bottom: 5px;
        }

        .context-paragraph {
            text-align: center;
            margin: 10px 0 30px 0;
            padding: 15px 25px;
            background-color: #f0f8ff;
            border-left: 8px solid #007BFF;
            border-radius: 8px;
            color: #1A3E60;
            font-size: 1.05em;
            font-weight: 500;
            border: 1px solid #cceeff;
            box-shadow: 0 4px 10px rgba(0, 123, 255, 0.15);
        }

        /* --- Resumen Superior (Scores & Donut Charts & Radar) --- */
        .scores-summary-top {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px;
            background-color: #DDEBF6;
            border-radius: 8px;
            margin-bottom: 30px;
            flex-wrap: wrap;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
            gap: 15px;
        }

        .overall-summary-block {
            flex-basis: 25%;
            min-width: 150px;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 10px 15px;
            background-color: #C0DFF0;
            border-radius: 5px;
        }

        .overall-score-top {
            font-size: 1.6em;
            font-weight: bold;
            color: #1A5276;
            text-align: center;
        }

        .overall-score-top span {
            color: #C82333;
            font-size: 1.2em;
        }

        .overall-item-count {
            font-size: 0.9em;
            color: #4A657C;
            margin-top: 5px;
            font-weight: 500;
        }

        /* Contenedor Gr√°ficos: organiza el radar y los donuts */
        .charts-container {
            flex-basis: 70%;
            display: flex;
            justify-content: space-around;
            gap: 15px;
            align-items: flex-start;
            flex-wrap: wrap;
        }

        /* Gr√°fico Radial */
        .radial-chart-container {
            flex-basis: 45%;
            min-width: 200px;
            display: flex;
            justify-content: center;
            align-items: center;
            margin-top: 10px;
            margin-bottom: 10px;
        }

        #cyberRadarChart {
            width: 100%;
            max-width: 220px;
            height: auto;
        }

        /* Estilos SVG para el Radar */
        .radar-axis {
            stroke: #A0B2C6;
            stroke-width: 1.2;
        }

        .radar-shape {
            fill: rgba(70, 130, 180, 0.5);
            stroke: #4682B4;
            stroke-width: 2.5;
            transition: all 0.5s ease-out;
        }

        .radar-label {
            font-size: 10px;
            fill: #5A7C9B;
            text-anchor: middle;
            font-weight: 500;
        }

        /* --- Donut Charts (Gr√°ficos de Tipo de Item) --- */
        .donut-list {
            display: flex;
            flex-basis: 50%;
            justify-content: space-around;
            gap: 10px;
            min-width: 200px;
        }

        .donut-chart {
            width: 30%;
            min-width: 80px;
            height: 120px;
            position: relative;
        }

        .donut-chart svg {
            display: block;
            width: 100%;
            height: auto;
            margin-top: 10px;
            /* Rotaci√≥n 90 grados a la izquierda para que 0% est√© arriba */
            transform: rotate(-90deg);
        }

        .donut-title {
            text-align: center;
            font-size: 0.8em;
            font-weight: bold;
            color: #1A3E60;
            margin-top: -5px;
            position: absolute;
            bottom: 10px;
            left: 0;
            right: 0;
        }

        .donut-percentage {
            position: absolute;
            top: 50%;
            left: 50%;
            /* Se elimina la rotaci√≥n extra en el porcentaje para que quede vertical */
            transform: translate(-50%, -50%);
            font-size: 1.1em;
            font-weight: bold;
            color: #333;
        }
        
        /* Estilos SVG de Donut */
        .donut-circle-bg {
            fill: none;
            stroke: #ccc;
            stroke-width: 10;
        }
        
        .donut-circle-progress {
            fill: none;
            stroke-width: 10;
            stroke-linecap: round;
            transition: stroke-dashoffset 0.5s ease-out;
        }

        /* --- Checklist Grid --- */
        .checklist-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin-top: 30px;
        }

        .category-card {
            background-color: #ffffff;
            border: 1px solid #ddd;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05);
            transition: transform 0.2s, box-shadow 0.2s;
            cursor: pointer;
        }

        .category-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
        }

        .card-header {
            background-color: #007BFF;
            color: white;
            padding: 15px;
            display: flex;
            align-items: center;
            font-size: 1.2em;
            font-weight: bold;
        }

        .card-header .icon {
            font-size: 1.5em;
            margin-right: 10px;
        }

        .card-body {
            padding: 15px;
        }

        .card-score {
            font-size: 2.5em;
            font-weight: bold;
            color: #28a745;
            text-align: center;
            margin-bottom: 10px;
        }

        .card-score.low { color: #dc3545; }
        .card-score.medium { color: #ffc107; }

        .card-details {
            display: flex;
            justify-content: space-around;
            text-align: center;
            font-size: 0.9em;
            color: #6c757d;
            margin-top: 10px;
            padding-top: 10px;
            border-top: 1px solid #eee;
        }
        
        .detail-group {
            flex: 1;
            padding: 0 5px;
        }

        .detail-group span:first-child {
            display: block;
            font-size: 1.2em;
            font-weight: bold;
            color: #495057;
        }

        .detail-group span:last-child {
            display: block;
            font-size: 0.8em;
            font-weight: normal;
            color: #6c757d;
            line-height: 1.2;
        }

        /* --- MODAL GENERAL (Checklist) --- */
        .modal {
            display: none;
            position: fixed;
            z-index: 100; /* Asegura que est√© por encima de todo */
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0, 0, 0, 0.6); /* Fondo semi-transparente */
        }

        #checklistModal .modal-content {
            background-color: #fefefe;
            /* Centrado Vertical y Horizontal */
            margin: 5% auto;
            padding: 30px;
            border: 1px solid #888;
            width: 80%;
            max-width: 700px;
            border-radius: 8px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.5);
            position: relative;
        }
        
        .close-button {
            color: #aaa;
            float: right;
            font-size: 28px;
            font-weight: bold;
        }

        .close-button:hover,
        .close-button:focus {
            color: #333;
            text-decoration: none;
            cursor: pointer;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            border-bottom: 2px solid #eee;
            padding-bottom: 10px;
        }

        .modal-title-group {
            display: flex;
            align-items: center;
        }

        .modal-section-score {
            font-size: 1.5em;
            font-weight: bold;
            color: #007BFF;
            margin-left: 15px;
        }

        .modal-controls button {
            padding: 8px 15px;
            margin-left: 10px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-weight: bold;
        }

        .save-button {
            background-color: #28a745;
            color: white;
        }

        .clear-button {
            background-color: #dc3545;
            color: white;
        }

        .checklist-item {
            padding: 10px 0;
            border-bottom: 1px dashed #eee;
            transition: background-color 0.2s;
        }

        .checklist-item.completed {
            background-color: #f7fff7;
        }

        .checklist-row {
            display: flex;
            align-items: center;
            margin-bottom: 5px;
        }

        .checklist-row input[type="checkbox"] {
            margin-right: 15px;
            transform: scale(1.3);
            cursor: pointer;
        }
        
        .item-title {
            font-weight: bold;
            color: #333;
            flex-grow: 1;
        }

        .item-detail {
            font-size: 0.9em;
            color: #6c757d;
            padding-left: 30px;
            margin-bottom: 5px;
        }

        .level-tag {
            font-size: 0.75em;
            padding: 3px 8px;
            border-radius: 12px;
            font-weight: bold;
            margin-left: 30px;
            display: inline-block;
        }

        .level-basico { background-color: #D4EDDA; color: #155724; }
        .level-avanzado { background-color: #FFF3CD; color: #856404; }
        .level-opcional { background-color: #D6D8D9; color: #495057; }

        /* --- Estilos para el bot√≥n de exportar/guardar --- */
        .save-button-container {
            text-align: center;
            margin-top: 30px;
            padding-top: 20px;
            border-top: 1px solid #ddd;
        }

        #exportarPDF {
            background-color: #1A5276; /* Un azul oscuro que contrasta */
            color: white;
            border: none;
            padding: 12px 25px;
            font-size: 1.1em;
            font-weight: bold;
            border-radius: 6px;
            cursor: pointer;
            transition: background-color 0.3s ease;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        #exportarPDF:hover {
            background-color: #28a745; /* Verde al pasar el rat√≥n */
        }
        
        /* --- Estilos de impresi√≥n (Reporte PDF) --- */
        @media print {
            /* Oculta elementos no deseados al imprimir */
            .context-paragraph,
            .modal,
            .save-button-container,
            #hiddenChecklistData {
                display: none !important;
            }
            
            /* Mostrar el nombre de la persona en la impresi√≥n */
            #nombrePersona {
                display: block !important;
                margin-bottom: 20px;
                padding: 5px 0;
                border-bottom: 1px solid #333; /* A√±adir una l√≠nea para est√©tica */
            }

            /* Asegurar que las gr√°ficas se vean bien */
            .scores-summary-top {
                border: none;
                box-shadow: none;
            }
            
            /* Asegura que todos los elementos sean visibles y sin fondo */
            body, .container {
                background-color: white !important;
                box-shadow: none !important;
                padding: 0;
            }
            
            /* Ajuste para que las gr√°ficas radiales tengan fondo */
            .radial-chart-container, .donut-chart {
                background-color: #f7f7f7; 
                border: 1px solid #eee;
                padding: 5px;
            }
        }
        
        @media (max-width: 768px) {
            .scores-summary-top {
                flex-direction: column;
                align-items: stretch;
            }

            .overall-summary-block {
                flex-basis: 100%;
                margin-bottom: 15px;
            }

            .charts-container {
                flex-basis: 100%;
                flex-direction: column;
                align-items: center;
            }

            .donut-list {
                width: 100%;
                justify-content: space-between;
                margin-top: 15px;
            }

            #checklistModal .modal-content {
                width: 95%;
                margin: 10px auto;
                padding: 15px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üõ°Ô∏è Evaluaci√≥n de Ciberseguridad Personal (V2.0)</h1>

        <p class="context-paragraph">
            Este CheckList es una Evaluaci√≥n de Ciberseguridad gratuita y su prop√≥sito es proporcionarte asistencia y una "nota" en el √°mbito de la Ciberseguridad. Est√° dirigido tanto a usuarios sin experiencia previa como a aquellos que ya cuentan con conocimientos en la materia.
        </p>

        <div class="scores-summary-top">
            <div class="overall-summary-block">
                <div class="overall-score-top">Tu Progreso es: <span id="promedioGeneral">0%</span></div>
                <div class="overall-item-count">
                    <span id="totalCheckedItems">0</span> de <span id="totalItems">60</span> Items Completados
                </div>
            </div>
            <div class="charts-container">
                <div class="radial-chart-container">
                    <svg id="cyberRadarChart" viewBox="0 0 200 200"></svg>
                </div>
                <div class="donut-list">
                    <div class="donut-chart" id="donutBasico">
                        <svg viewBox="0 0 100 100">
                            <circle class="donut-circle-bg" cx="50" cy="50" r="45"></circle>
                            <circle id="donutCircleBasico" class="donut-circle-progress" cx="50" cy="50" r="45" stroke="#28A745" stroke-dasharray="282.7 282.7" stroke-dashoffset="282.7"></circle>
                        </svg>
                        <div class="donut-percentage" id="donutPercentBasico">0%</div>
                        <div class="donut-title">B√°sico</div>
                    </div>
                    <div class="donut-chart" id="donutAvanzado">
                        <svg viewBox="0 0 100 100">
                            <circle class="donut-circle-bg" cx="50" cy="50" r="45"></circle>
                            <circle id="donutCircleAvanzado" class="donut-circle-progress" cx="50" cy="50" r="45" stroke="#FFC107" stroke-dasharray="282.7 282.7" stroke-dashoffset="282.7"></circle>
                        </svg>
                        <div class="donut-percentage" id="donutPercentAvanzado">0%</div>
                        <div class="donut-title">Avanzado</div>
                    </div>
                    <div class="donut-chart" id="donutOpcional">
                        <svg viewBox="0 0 100 100">
                            <circle class="donut-circle-bg" cx="50" cy="50" r="45"></circle>
                            <circle id="donutCircleOpcional" class="donut-circle-progress" cx="50" cy="50" r="45" stroke="#6C757D" stroke-dasharray="282.7 282.7" stroke-dashoffset="282.7"></circle>
                        </svg>
                        <div class="donut-percentage" id="donutPercentOpcional">0%</div>
                        <div class="donut-title">Opcional</div>
                    </div>
                </div>
            </div>
        </div>
        <div class="checklist-grid">
            <div class="category-card" onclick="openModal('autenticacion')">
                <div class="card-header"><span class="icon">üîë</span> Autenticaci√≥n</div>
                <div class="card-body">
                    <div class="card-score" id="scoreAutenticacion">0%</div>
                    <div class="card-details">
                        <div class="detail-group">
                            <span id="checkedAutenticacion">0</span>
                            <span>Completados</span>
                        </div>
                        <div class="detail-group">
                            <span id="totalAutenticacion">10</span>
                            <span>Totales</span>
                        </div>
                    </div>
                </div>
            </div>
            <div class="category-card" onclick="openModal('moviles')">
                <div class="card-header"><span class="icon">üì±</span> M√≥viles</div>
                <div class="card-body">
                    <div class="card-score" id="scoreMoviles">0%</div>
                    <div class="card-details">
                        <div class="detail-group">
                            <span id="checkedMoviles">0</span>
                            <span>Completados</span>
                        </div>
                        <div class="detail-group">
                            <span id="totalMoviles">10</span>
                            <span>Totales</span>
                        </div>
                    </div>
                </div>
            </div>
            <div class="category-card" onclick="openModal('pc')">
                <div class="card-header"><span class="icon">üíª</span> PC y Escritorio</div>
                <div class="card-body">
                    <div class="card-score" id="scorePC">0%</div>
                    <div class="card-details">
                        <div class="detail-group">
                            <span id="checkedPC">0</span>
                            <span>Completados</span>
                        </div>
                        <div class="detail-group">
                            <span id="totalPC">10</span>
                            <span>Totales</span>
                        </div>
                    </div>
                </div>
            </div>
            <div class="category-card" onclick="openModal('navegacion')">
                <div class="card-header"><span class="icon">üåê</span> Navegaci√≥n Web</div>
                <div class="card-body">
                    <div class="card-score" id="scoreNavegacion">0%</div>
                    <div class="card-details">
                        <div class="detail-group">
                            <span id="checkedNavegacion">0</span>
                            <span>Completados</span>
                        </div>
                        <div class="detail-group">
                            <span id="totalNavegacion">10</span>
                            <span>Totales</span>
                        </div>
                    </div>
                </div>
            </div>
            <div class="category-card" onclick="openModal('correo')">
                <div class="card-header"><span class="icon">üìß</span> Correo Electr√≥nico</div>
                <div class="card-body">
                    <div class="card-score" id="scoreCorreo">0%</div>
                    <div class="card-details">
                        <div class="detail-group">
                            <span id="checkedCorreo">0</span>
                            <span>Completados</span>
                        </div>
                        <div class="detail-group">
                            <span id="totalCorreo">10</span>
                            <span>Totales</span>
                        </div>
                    </div>
                </div>
            </div>
            <div class="category-card" onclick="openModal('respaldo')">
                <div class="card-header"><span class="icon">üíæ</span> Respaldo</div>
                <div class="card-body">
                    <div class="card-score" id="scoreRespaldo">0%</div>
                    <div class="card-details">
                        <div class="detail-group">
                            <span id="checkedRespaldo">0</span>
                            <span>Completados</span>
                        </div>
                        <div class="detail-group">
                            <span id="totalRespaldo">10</span>
                            <span>Totales</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="save-button-container">
            <button id="exportarPDF" onclick="exportarResultados()">
                üíæ Guardar / Imprimir mi Evaluaci√≥n
            </button>
        </div>
    </div>
    
    <div id="nombrePersona" style="display: none; text-align: center; margin-top: 20px; font-size: 1.5em; font-weight: bold; color: #1A3E60; padding: 10px; border-top: 2px solid #ddd;"></div>

    <div id="checklistModal" class="modal">
        <div class="modal-content">
            <span class="close-button" onclick="closeModal()">&times;</span>
            <div class="modal-header">
                <div class="modal-title-group">
                    <h2 id="modalTitle">Detalles del Checklist</h2>
                    <span id="modalSectionScore" class="modal-section-score">0%</span>
                </div>
                <div class="modal-controls">
                    <button class="save-button" onclick="saveAndCloseModal()">Guardar y Cerrar</button>
                    <button class="clear-button" onclick="clearCurrentSection()">Borrar Items Seleccionados</button>
                </div>
            </div>
            <div id="modalBody">
                </div>
        </div>
    </div>

    <div id="hiddenChecklistData" style="display: none;">
        <section data-sectionname="autenticacion" data-title="Checklist de Autenticaci√≥n (10 √çtems)">
             <div class="checklist-item" data-item-level="basico">
                 <div class="checklist-row">
                     <input type="checkbox" id="auth_pass_manager">
                     <label for="auth_pass_manager" class="item-title">1. Usar un gestor de contrase√±as confiable (LastPass, 1Password, etc.).</label>
                 </div>
                 <div class="item-detail">Facilita la creaci√≥n y gesti√≥n de contrase√±as complejas y √∫nicas para cada servicio.</div>
                 <span class="level-tag level-basico">B√°sico</span>
             </div>
             <div class="checklist-item" data-item-level="basico">
                 <div class="checklist-row">
                     <input type="checkbox" id="auth_2fa_critical">
                     <label for="auth_2fa_critical" class="item-title">2. Activar 2FA en cuentas <span class="emphasis">cr√≠ticas</span> (email, bancos, redes principales).</label>
                 </div>
                 <div class="item-detail">La autenticaci√≥n de dos factores es vital contra el robo de contrase√±as.</div>
                 <span class="level-tag level-basico">B√°sico</span>
             </div>
             <div class="checklist-item" data-item-level="basico">
                 <div class="checklist-row">
                     <input type="checkbox" id="auth_pass_complexity">
                     <label for="auth_pass_complexity" class="item-title">3. Asegurar que las contrase√±as cr√≠ticas tengan m√°s de 12 caracteres y variedad.</label>
                 </div>
                 <div class="item-detail">Las contrase√±as largas y complejas son exponencialmente m√°s dif√≠ciles de adivinar o romper.</div>
                 <span class="level-tag level-basico">B√°sico</span>
             </div>
             <div class="checklist-item" data-item-level="basico">
                 <div class="checklist-row">
                     <input type="checkbox" id="auth_unique_pass">
                     <label for="auth_unique_pass" class="item-title">4. Usar una contrase√±a √öNICA para cada servicio en l√≠nea.</label>
                 </div>
                 <div class="item-detail">Evita que una violaci√≥n de datos en un sitio comprometa todas sus cuentas.</div>
                 <span class="level-tag level-basico">B√°sico</span>
             </div>
             <div class="checklist-item" data-item-level="avanzado">
                 <div class="checklist-row">
                     <input type="checkbox" id="auth_2fa_app">
                     <label for="auth_2fa_app" class="item-title">5. Usar app de autenticaci√≥n (ej: Google Authenticator) en lugar de SMS para el 2FA.</label>
                 </div>
                 <div class="item-detail">Los c√≥digos por SMS pueden ser interceptados. Las apps son m√°s seguras.</div>
                 <span class="level-tag level-avanzado">Avanzado</span>
             </div>
             <div class="checklist-item" data-item-level="avanzado">
                 <div class="checklist-row">
                     <input type="checkbox" id="auth_check_leaks">
                     <label for="auth_check_leaks" class="item-title">6. Monitorear si tus contrase√±as han sido filtradas (Have I Been Pwned).</label>
                 </div>
                 <div class="item-detail">Verifica si alguna de tus credenciales ha sido comprometida en fugas de datos.</div>
                 <span class="level-tag level-avanzado">Avanzado</span>
             </div>
             <div class="checklist-item" data-item-level="avanzado">
                 <div class="checklist-row">
                     <input type="checkbox" id="auth_account_review">
                     <label for="auth_account_review" class="item-title">7. Revisar y eliminar peri√≥dicamente cuentas antiguas o servicios que ya no usa.</label>
                 </div>
                 <div class="item-detail">Reduce la "huella" digital y el riesgo de que una cuenta olvidada sea comprometida.</div>
                 <span class="level-tag level-avanzado">Avanzado</span>
             </div>
             <div class="checklist-item" data-item-level="opcional">
                 <div class="checklist-row">
                     <input type="checkbox" id="auth_fido">
                     <label for="auth_fido" class="item-title">8. Considerar el uso de llaves de seguridad f√≠sica (FIDO/Yubikey).</label>
                 </div>
                 <div class="item-detail">Es la forma m√°s segura de autenticaci√≥n de dos factores.</div>
                 <span class="level-tag level-opcional">Opcional</span>
             </div>
             <div class="checklist-item" data-item-level="opcional">
                 <div class="checklist-row">
                     <input type="checkbox" id="auth_passwordless">
                     <label for="auth_passwordless" class="item-title">9. Habilitar la autenticaci√≥n sin contrase√±a (Passkeys) donde sea posible.</label>
                 </div>
                 <div class="item-detail">Passkeys son resistentes al phishing y m√°s seguras que las contrase√±as tradicionales.</div>
                 <span class="level-tag level-opcional">Opcional</span>
             </div>
             <div class="checklist-item" data-item-level="opcional">
                 <div class="checklist-row">
                     <input type="checkbox" id="auth_biometric_pc">
                     <label for="auth_biometric_pc" class="item-title">10. Usar biometr√≠a (huella/rostro) en el PC para desbloqueo r√°pido y seguro.</label>
                 </div>
                 <div class="item-detail">Aumenta la conveniencia sin comprometer la seguridad de la sesi√≥n.</div>
                 <span class="level-tag level-opcional">Opcional</span>
             </div>
        </section>

        <section data-sectionname="moviles" data-title="Checklist de Dispositivos M√≥viles (10 √çtems)">
             <div class="checklist-item" data-item-level="basico">
                 <div class="checklist-row">
                     <input type="checkbox" id="mobile_pass_lock">
                     <label for="mobile_pass_lock" class="item-title">1. Configurar contrase√±a, PIN o biometr√≠a <span class="emphasis">fuerte</span> para el desbloqueo.</label>
                 </div>
                 <div class="item-detail">Protege tu dispositivo con un m√©todo de desbloqueo robusto.</div>
                 <span class="level-tag level-basico">B√°sico</span>
             </div>
             <div class="checklist-item" data-item-level="basico">
                 <div class="checklist-row">
                     <input type="checkbox" id="mobile_updates">
                     <label for="mobile_updates" class="item-title">2. Mantener el sistema operativo y apps <span class="emphasis">actualizadas</span>.</label>
                 </div>
                 <div class="item-detail">Las actualizaciones incluyen parches de seguridad cr√≠ticos.</div>
                 <span class="level-tag level-basico">B√°sico</span>
             </div>
             <div class="checklist-item" data-item-level="basico">
                 <div class="checklist-row">
                     <input type="checkbox" id="mobile_find_device">
                     <label for="mobile_find_device" class="item-title">3. Activar la funci√≥n "Encontrar mi dispositivo" (Find My, Find My Device).</label>
                 </div>
                 <div class="item-detail">Permite localizar o borrar remotamente el dispositivo en caso de p√©rdida o robo.</div>
                 <span class="level-tag level-basico">B√°sico</span>
             </div>
             <div class="checklist-item" data-item-level="basico">
                 <div class="checklist-row">
                     <input type="checkbox" id="mobile_app_source">
                     <label for="mobile_app_source" class="item-title">4. Descargar apps <span class="emphasis">solo</span> desde tiendas oficiales (App Store, Play Store).</label>
                 </div>
                 <div class="item-detail">Las tiendas oficiales revisan las apps en busca de malware. Evite la instalaci√≥n de archivos .APK o fuentes desconocidas.</div>
                 <span class="level-tag level-basico">B√°sico</span>
             </div>
             <div class="checklist-item" data-item-level="avanzado">
                 <div class="checklist-row">
                     <input type="checkbox" id="mobile_sim_lock">
                     <label for="mobile_sim_lock" class="item-title">5. Configurar un PIN para la tarjeta SIM.</label>
                 </div>
                 <div class="item-detail">Evita el "SIM Swapping" y que usen tu SIM en otro tel√©fono para recibir c√≥digos 2FA.</div>
                 <span class="level-tag level-avanzado">Avanzado</span>
             </div>
             <div class="checklist-item" data-item-level="avanzado">
                 <div class="checklist-row">
                     <input type="checkbox" id="mobile_review_permissions">
                     <label for="mobile_review_permissions" class="item-title">6. Revisar y limitar los permisos de las apps (ej: ¬ønecesita mi linterna acceso a contactos?).</label>
                 </div>
                 <div class="item-detail">Las apps maliciosas solicitan permisos excesivos para espiar o robar datos.</div>
                 <span class="level-tag level-avanzado">Avanzado</span>
             </div>
             <div class="checklist-item" data-item-level="avanzado">
                 <div class="checklist-row">
                     <input type="checkbox" id="mobile_public_wifi_vpn">
                     <label for="mobile_public_wifi_vpn" class="item-title">7. Usar VPN de confianza en redes Wi-Fi p√∫blicas o datos m√≥viles para transacciones.</label>
                 </div>
                 <div class="item-detail">Una VPN encripta tu tr√°fico, protegi√©ndote de interceptaciones de datos en redes abiertas.</div>
                 <span class="level-tag level-avanzado">Avanzado</span>
             </div>
             <div class="checklist-item" data-item-level="opcional">
                 <div class="checklist-row">
                     <input type="checkbox" id="mobile_ad_block">
                     <label for="mobile_ad_block" class="item-title">8. Usar un bloqueador de anuncios o un navegador enfocado en la privacidad.</label>
                 </div>
                 <div class="item-detail">Bloquea rastreadores y reduce la exposici√≥n a publicidad maliciosa (*malvertising*).</div>
                 <span class="level-tag level-opcional">Opcional</span>
             </div>
             <div class="checklist-item" data-item-level="opcional">
                 <div class="checklist-row">
                     <input type="checkbox" id="mobile_encryption">
                     <label for="mobile_encryption" class="item-title">9. Verificar que el dispositivo (Android) tenga el almacenamiento encriptado.</label>
                 </div>
                 <div class="item-detail">La encriptaci√≥n es est√°ndar en la mayor√≠a de los dispositivos modernos (iOS y Android recientes), pero es bueno verificarlo.</div>
                 <span class="level-tag level-opcional">Opcional</span>
             </div>
             <div class="checklist-item" data-item-level="opcional">
                 <div class="checklist-row">
                     <input type="checkbox" id="mobile_nfc_off">
                     <label for="mobile_nfc_off" class="item-title">10. Desactivar NFC/Bluetooth cuando no se est√©n utilizando.</label>
                 </div>
                 <div class="item-detail">Reduce la superficie de ataque y el riesgo de conexi√≥n no deseada con dispositivos cercanos.</div>
                 <span class="level-tag level-opcional">Opcional</span>
             </div>
        </section>

        <section data-sectionname="pc" data-title="Checklist de PC y Escritorio (10 √çtems)">
            <div class="checklist-item" data-item-level="basico">
                <div class="checklist-row">
                    <input type="checkbox" id="pc_pass_login">
                    <label for="pc_pass_login" class="item-title">1. Establecer contrase√±a <span class="emphasis">robusta</span> para iniciar sesi√≥n en el sistema operativo.</label>
                </div>
                <div class="item-detail">Una contrase√±a fuerte es la primera l√≠nea de defensa contra accesos no autorizados.</div>
                <span class="level-tag level-basico">B√°sico</span>
            </div>
            <div class="checklist-item" data-item-level="basico">
                <div class="checklist-row">
                    <input type="checkbox" id="pc_antivirus">
                    <label for="pc_antivirus" class="item-title">2. Tener antivirus/antimalware confiable instalado y actualizado (ej: Windows Defender).</label>
                </div>
                <div class="item-detail">Un buen software de seguridad detecta y elimina amenazas en tiempo real.</div>
                <span class="level-tag level-basico">B√°sico</span>
            </div>
            <div class="checklist-item" data-item-level="basico">
                <div class="checklist-row">
                    <input type="checkbox" id="pc_os_updates">
                    <label for="pc_os_updates" class="item-title">3. Instalar <span class="emphasis">inmediatamente</span> las actualizaciones cr√≠ticas del Sistema Operativo.</label>
                </div>
                <div class="item-detail">Las actualizaciones corrigen vulnerabilidades que los atacantes usan para entrar.</div>
                <span class="level-tag level-basico">B√°sico</span>
            </div>
            <div class="checklist-item" data-item-level="basico">
                <div class="checklist-row">
                    <input type="checkbox" id="pc_firewall">
                    <label for="pc_firewall" class="item-title">4. Mantener el firewall (cortafuegos) activado en todo momento.</label>
                </div>
                <div class="item-detail">El firewall controla y restringe el tr√°fico de red entrante y saliente.</div>
                <span class="level-tag level-basico">B√°sico</span>
            </div>
            <div class="checklist-item" data-item-level="avanzado">
                <div class="checklist-row">
                    <input type="checkbox" id="pc_disk_encrypt">
                    <label for="pc_disk_encrypt" class="item-title">5. Activar la encriptaci√≥n de disco completo (BitLocker, FileVault).</label>
                </div>
                <div class="item-detail">Protege tus datos si el dispositivo es robado o lo pierdes.</div>
                <span class="level-tag level-avanzado">Avanzado</span>
            </div>
            <div class="checklist-item" data-item-level="avanzado">
                <div class="checklist-row">
                    <input type="checkbox" id="pc_admin_limit">
                    <label for="pc_admin_limit" class="item-title">6. Usar una cuenta sin privilegios de administrador para el uso diario.</label>
                </div>
                <div class="item-detail">Limita el da√±o que el malware puede hacer si infecta tu sistema (es una pr√°ctica corporativa clave).</div>
                <span class="level-tag level-avanzado">Avanzado</span>
            </div>
            <div class="checklist-item" data-item-level="avanzado">
                <div class="checklist-row">
                    <input type="checkbox" id="pc_unused_apps">
                    <label for="pc_unused_apps" class="item-title">7. Desinstalar software y aplicaciones que ya no utiliza.</label>
                </div>
                <div class="item-detail">Cada programa es una potencial vulnerabilidad. Reduzca la superficie de ataque.</div>
                <span class="level-tag level-avanzado">Avanzado</span>
            </div>
            <div class="checklist-item" data-item-level="opcional">
                <div class="checklist-row">
                    <input type="checkbox" id="pc_usb_block">
                    <label for="pc_usb_block" class="item-title">8. Desactivar la ejecuci√≥n autom√°tica de memorias USB o discos externos.</label>
                </div>
                <div class="item-detail">Evita que un malware se ejecute autom√°ticamente al conectar un dispositivo desconocido.</div>
                <span class="level-tag level-opcional">Opcional</span>
            </div>
             <div class="checklist-item" data-item-level="opcional">
                <div class="checklist-row">
                    <input type="checkbox" id="pc_webcam_cover">
                    <label for="pc_webcam_cover" class="item-title">9. Usar una cubierta f√≠sica para la webcam y/o micr√≥fono cuando no se usan.</label>
                </div>
                <div class="item-detail">Medida sencilla contra el espionaje por malware de acceso remoto.</div>
                <span class="level-tag level-opcional">Opcional</span>
            </div>
             <div class="checklist-item" data-item-level="opcional">
                <div class="checklist-row">
                    <input type="checkbox" id="pc_guest_limit">
                    <label for="pc_guest_limit" class="item-title">10. Desactivar la cuenta de invitado (Guest Account) o limitarla severamente.</label>
                </div>
                <div class="item-detail">Las cuentas de invitado son a menudo olvidadas y pueden ser explotadas si tienen permisos innecesarios.</div>
                <span class="level-tag level-opcional">Opcional</span>
            </div>
        </section>

        <section data-sectionname="navegacion" data-title="Checklist de Navegaci√≥n Web (10 √çtems)">
            <div class="checklist-item" data-item-level="basico">
                <div class="checklist-row">
                    <input type="checkbox" id="nav_secure_sites">
                    <label for="nav_secure_sites" class="item-title">1. Verificar que los sitios web sean HTTPS (candado en la URL) <span class="emphasis">siempre</span>.</label>
                </div>
                <div class="item-detail">Asegura que tu conexi√≥n con el sitio est√© encriptada y sea privada, especialmente en bancos y compras.</div>
                <span class="level-tag level-basico">B√°sico</span>
            </div>
            <div class="checklist-item" data-item-level="basico">
                <div class="checklist-row">
                    <input type="checkbox" id="nav_popups">
                    <label for="nav_popups" class="item-title">2. Bloquear Pop-ups y notificaciones intrusivas en el navegador.</label>
                </div>
                <div class="item-detail">Reduce la superficie de ataque y la exposici√≥n a contenido malicioso.</div>
                <span class="level-tag level-basico">B√°sico</span>
            </div>
            <div class="checklist-item" data-item-level="basico">
                <div class="checklist-row">
                    <input type="checkbox" id="nav_browser_updates">
                    <label for="nav_browser_updates" class="item-title">3. Mantener el navegador (Chrome, Edge, Firefox) y sus componentes actualizados.</label>
                </div>
                <div class="item-detail">Las vulnerabilidades del navegador son explotadas constantemente.</div>
                <span class="level-tag level-basico">B√°sico</span>
            </div>
            <div class="checklist-item" data-item-level="basico">
                <div class="checklist-row">
                    <input type="checkbox" id="nav_session_close">
                    <label for="nav_session_close" class="item-title">4. Cerrar sesi√≥n en sitios bancarios, de compras o de trabajo al terminar de usarlos.</label>
                </div>
                <div class="item-detail">Evita que alguien que use su equipo despu√©s pueda acceder a sus cuentas.</div>
                <span class="level-tag level-basico">B√°sico</span>
            </div>
            <div class="checklist-item" data-item-level="avanzado">
                <div class="checklist-row">
                    <input type="checkbox" id="nav_ext_check">
                    <label for="nav_ext_check" class="item-title">5. Revisar y limitar el n√∫mero de extensiones del navegador solo a las necesarias.</label>
                </div>
                <div class="item-detail">Las extensiones pueden tener acceso total a su navegaci√≥n y datos. Elimine las que no use o no sean confiables.</div>
                <span class="level-tag level-avanzado">Avanzado</span>
            </div>
            <div class="checklist-item" data-item-level="avanzado">
                <div class="checklist-row">
                    <input type="checkbox" id="nav_cookies_limit">
                    <label for="nav_cookies_limit" class="item-title">6. Configurar el navegador para borrar cookies y datos de sitios al cerrarlo (o usar el modo inc√≥gnito).</label>
                </div>
                <div class="item-detail">Limita el rastreo entre sitios por parte de terceros.</div>
                <span class="level-tag level-avanzado">Avanzado</span>
            </div>
            <div class="checklist-item" data-item-level="avanzado">
                <div class="checklist-row">
                    <input type="checkbox" id="nav_privacy_mode">
                    <label for="nav_privacy_mode" class="item-title">7. Usar el "Modo de Privacidad" o "Controles de Seguimiento" del navegador.</label>
                </div>
                <div class="item-detail">Configura los ajustes de seguridad del navegador a un nivel alto.</div>
                <span class="level-tag level-avanzado">Avanzado</span>
            </div>
            <div class="checklist-item" data-item-level="opcional">
                <div class="checklist-row">
                    <input type="checkbox" id="nav_dns_secure">
                    <label for="nav_dns_secure" class="item-title">8. Configurar DNS seguro (ej. Cloudflare 1.1.1.1, Google 8.8.8.8) a nivel de sistema.</label>
                </div>
                <div class="item-detail">Mejora la privacidad y puede bloquear acceso a sitios de malware conocidos antes de que se carguen.</div>
                <span class="level-tag level-opcional">Opcional</span>
            </div>
            <div class="checklist-item" data-item-level="opcional">
                <div class="checklist-row">
                    <input type="checkbox" id="nav_tor">
                    <label for="nav_tor" class="item-title">9. Usar un navegador como Tor o Brave para b√∫squedas que requieren anonimato total.</label>
                </div>
                <div class="item-detail">Para informaci√≥n muy sensible o investigaci√≥n, el anonimato es la mejor defensa.</div>
                <span class="level-tag level-opcional">Opcional</span>
            </div>
            <div class="checklist-item" data-item-level="opcional">
                <div class="checklist-row">
                    <input type="checkbox" id="nav_virtual_machine">
                    <label for="nav_virtual_machine" class="item-title">10. Usar una m√°quina virtual (VM) para navegar por sitios de alto riesgo (ej. software pirata).</label>
                </div>
                <div class="item-detail">Si la VM se infecta, no afectar√° a su sistema operativo principal.</div>
                <span class="level-tag level-opcional">Opcional</span>
            </div>
        </section>

        <section data-sectionname="correo" data-title="Checklist de Correo Electr√≥nico (10 √çtems)">
            <div class="checklist-item" data-item-level="basico">
                <div class="checklist-row">
                    <input type="checkbox" id="email_attachments">
                    <label for="email_attachments" class="item-title">1. Ser <span class="emphasis">extremadamente cauteloso</span> con adjuntos y enlaces de remitentes desconocidos.</label>
                </div>
                <div class="item-detail">El *phishing* y el *malware* se propagan principalmente a trav√©s de correos. ¬°No abra nada que no espera!</div>
                <span class="level-tag level-basico">B√°sico</span>
            </div>
            <div class="checklist-item" data-item-level="basico">
                <div class="checklist-row">
                    <input type="checkbox" id="email_sender_check">
                    <label for="email_sender_check" class="item-title">2. Verificar la direcci√≥n <span class="emphasis">completa</span> del remitente, no solo el nombre.</label>
                </div>
                <div class="item-detail">Los atacantes suelen usar direcciones similares (`@amazon-secure.com` en lugar de `@amazon.com`) para enga√±arle.</div>
                <span class="level-tag level-basico">B√°sico</span>
            </div>
            <div class="checklist-item" data-item-level="basico">
                <div class="checklist-row">
                    <input type="checkbox" id="email_urgent_suspicion">
                    <label for="email_urgent_suspicion" class="item-title">3. Desconfiar de correos con mensajes de urgencia o amenazas (ej. "su cuenta ser√° cerrada").</label>
                </div>
                <div class="item-detail">La urgencia es la t√°ctica m√°s com√∫n del phishing para hacerle actuar sin pensar.</div>
                <span class="level-tag level-basico">B√°sico</span>
            </div>
            <div class="checklist-item" data-item-level="basico">
                <div class="checklist-row">
                    <input type="checkbox" id="email_no_pass_request">
                    <label for="email_no_pass_request" class="item-title">4. NUNCA ingresar contrase√±as o datos de tarjeta en un enlace que llega por correo.</label>
                </div>
                <div class="item-detail">Las compa√±√≠as de buena reputaci√≥n siempre le pedir√°n iniciar sesi√≥n en su sitio web directamente.</div>
                <span class="level-tag level-basico">B√°sico</span>
            </div>
            <div class="checklist-item" data-item-level="avanzado">
                <div class="checklist-row">
                    <input type="checkbox" id="email_separate_acc">
                    <label for="email_separate_acc" class="item-title">5. Usar una direcci√≥n de correo separada para compras, suscripciones y redes sociales.</label>
                </div>
                <div class="item-detail">Minimiza el riesgo de que tu correo principal se vea afectado en una filtraci√≥n o spam.</div>
                <span class="level-tag level-avanzado">Avanzado</span>
            </div>
            <div class="checklist-item" data-item-level="avanzado">
                <div class="checklist-row">
                    <input type="checkbox" id="email_spam_check">
                    <label for="email_spam_check" class="item-title">6. Revisar el filtro de spam regularmente para asegurarse de que correos importantes no est√©n all√≠.</label>
                </div>
                <div class="item-detail">Aunque es un riesgo bajo, un atacante podr√≠a enviar un correo malicioso a una carpeta que usted no revisa.</div>
                <span class="level-tag level-avanzado">Avanzado</span>
            </div>
            <div class="checklist-item" data-item-level="avanzado">
                <div class="checklist-row">
                    <input type="checkbox" id="email_no_reply_forward">
                    <label for="email_no_reply_forward" class="item-title">7. Evitar reenviar correos corporativos sensibles a su cuenta personal.</label>
                </div>
                <div class="item-detail">Esto ayuda a mantener la informaci√≥n de la empresa dentro del per√≠metro seguro.</div>
                <span class="level-tag level-avanzado">Avanzado</span>
            </div>
            <div class="checklist-item" data-item-level="opcional">
                <div class="checklist-row">
                    <input type="checkbox" id="email_pgp">
                    <label for="email_pgp" class="item-title">8. Utilizar PGP o cifrado de extremo a extremo en correos con informaci√≥n sensible.</label>
                </div>
                <div class="item-detail">Garantiza que solo el destinatario pueda leer el contenido del mensaje.</div>
                <span class="level-tag level-opcional">Opcional</span>
            </div>
            <div class="checklist-item" data-item-level="opcional">
                <div class="checklist-row">
                    <input type="checkbox" id="email_alias">
                    <label for="email_alias" class="item-title">9. Usar servicios de alias de correo electr√≥nico (ej. SimpleLogin) para proteger su direcci√≥n real.</label>
                </div>
                <div class="item-detail">Si un alias se filtra, puede desactivarlo sin afectar su correo principal.</div>
                <span class="level-tag level-opcional">Opcional</span>
            </div>
            <div class="checklist-item" data-item-level="opcional">
                <div class="checklist-row">
                    <input type="checkbox" id="email_header_check">
                    <label for="email_header_check" class="item-title">10. Aprender a revisar los encabezados del correo (headers) para verificar la autenticidad de la fuente.</label>
                </div>
                <div class="item-detail">T√©cnica avanzada para detectar suplantaci√≥n de identidad (spoofing).</div>
                <span class="level-tag level-opcional">Opcional</span>
            </div>
        </section>

        <section data-sectionname="respaldo" data-title="Checklist de Respaldo y Recuperaci√≥n (10 √çtems)">
            <div class="checklist-item" data-item-level="basico">
                <div class="checklist-row">
                    <input type="checkbox" id="backup_critical_data">
                    <label for="backup_critical_data" class="item-title">1. Hacer copias de seguridad de <span class="emphasis">datos cr√≠ticos</span> (fotos, documentos) al menos mensualmente.</label>
                </div>
                <div class="item-detail">La p√©rdida de datos puede ocurrir por fallos de hardware, robo o ataques de *ransomware*.</div>
                <span class="level-tag level-basico">B√°sico</span>
            </div>
            <div class="checklist-item" data-item-level="basico">
                <div class="checklist-row">
                    <input type="checkbox" id="backup_cloud_check">
                    <label for="backup_cloud_check" class="item-title">2. Usar servicios de nube (Google Drive, OneDrive, iCloud) para la sincronizaci√≥n autom√°tica de archivos.</label>
                </div>
                <div class="item-detail">Es el m√©todo m√°s sencillo y accesible para la mayor√≠a de los usuarios.</div>
                <span class="level-tag level-basico">B√°sico</span>
            </div>
             <div class="checklist-item" data-item-level="basico">
                <div class="checklist-row">
                    <input type="checkbox" id="backup_mobile_data">
                    <label for="backup_mobile_data" class="item-title">3. Verificar que las fotos y contactos del m√≥vil se est√©n respaldando autom√°ticamente.</label>
                </div>
                <div class="item-detail">Es lo m√°s importante que la mayor√≠a de los usuarios necesita recuperar.</div>
                <span class="level-tag level-basico">B√°sico</span>
            </div>
            <div class="checklist-item" data-item-level="avanzado">
                <div class="checklist-row">
                    <input type="checkbox" id="backup_separate_media">
                    <label for="backup_separate_media" class="item-title">4. Mantener una copia de seguridad <span class="emphasis">desconectada</span> (Regla 3-2-1: al menos una copia *offline*).</label>
                </div>
                <div class="item-detail">Si un ransomware encripta su PC, no podr√° encriptar el disco de respaldo desconectado.</div>
                <span class="level-tag level-avanzado">Avanzado</span>
            </div>
            <div class="checklist-item" data-item-level="avanzado">
                <div class="checklist-row">
                    <input type="checkbox" id="backup_test_restore">
                    <label for="backup_test_restore" class="item-title">5. Probar peri√≥dicamente la restauraci√≥n de datos.</label>
                </div>
                <div class="item-detail">Aseg√∫rate de que la copia de seguridad realmente funcione y sea legible cuando la necesites.</div>
                <span class="level-tag level-avanzado">Avanzado</span>
            </div>
            <div class="checklist-item" data-item-level="avanzado">
                <div class="checklist-row">
                    <input type="checkbox" id="backup_encrypt_media">
                    <label for="backup_encrypt_media" class="item-title">6. Encriptar las copias de seguridad almacenadas en medios f√≠sicos (discos duros).</label>
                </div>
                <div class="item-detail">Protege los datos si el disco de respaldo es robado.</div>
                <span class="level-tag level-avanzado">Avanzado</span>
            </div>
            <div class="checklist-item" data-item-level="avanzado">
                <div class="checklist-row">
                    <input type="checkbox" id="backup_offsite">
                    <label for="backup_offsite" class="item-title">7. Tener al menos una copia de seguridad fuera de su ubicaci√≥n principal (ej. en la nube o en casa de un familiar).</label>
                </div>
                <div class="item-detail">Medida de protecci√≥n contra desastres f√≠sicos como incendios o inundaciones.</div>
                <span class="level-tag level-avanzado">Avanzado</span>
            </div>
            <div class="checklist-item" data-item-level="opcional">
                <div class="checklist-row">
                    <input type="checkbox" id="backup_versioning">
                    <label for="backup_versioning" class="item-title">8. Usar un software de respaldo que mantenga m√∫ltiples versiones de los archivos.</label>
                </div>
                <div class="item-detail">Le permite volver a un punto anterior si la versi√≥n m√°s reciente del archivo est√° corrupta o encriptada.</div>
                <span class="level-tag level-opcional">Opcional</span>
            </div>
             <div class="checklist-item" data-item-level="opcional">
                <div class="checklist-row">
                    <input type="checkbox" id="backup_system_image">
                    <label for="backup_system_image" class="item-title">9. Crear una imagen completa del sistema operativo para una restauraci√≥n r√°pida despu√©s de un fallo grave.</label>
                </div>
                <div class="item-detail">No solo recupera sus archivos, sino tambi√©n su configuraci√≥n y programas.</div>
                <span class="level-tag level-opcional">Opcional</span>
            </div>
             <div class="checklist-item" data-item-level="opcional">
                <div class="checklist-row">
                    <input type="checkbox" id="backup_password_store">
                    <label for="backup_password_store" class="item-title">10. Tener una copia de seguridad encriptada del gestor de contrase√±as guardada en un lugar seguro.</label>
                </div>
                <div class="item-detail">Vital para la recuperaci√≥n total de su vida digital.</div>
                <span class="level-tag level-opcional">Opcional</span>
            </div>
        </section>
        <section data-sectionname="navegacion" data-title="Checklist de Correo Electr√≥nico">
             </section>
        <section data-sectionname="correo" data-title="Checklist de Correo Electr√≥nico">
             </section>
    </div>

    <script>
        const allChecklistData = {};
        const allLevels = ['basico', 'avanzado', 'opcional'];
        const totalItemsInLevel = {};
        const checkedItemsInLevel = {};
        let currentSection = ''; // Variable para rastrear la secci√≥n abierta

        // 1.1 Cargar datos del HTML a la estructura JS
        document.querySelectorAll('#hiddenChecklistData section').forEach(section => {
            const name = section.dataset.sectionname;
            const title = section.dataset.title;
            const items = [];
            
            // Solo procesar si el nombre de la secci√≥n es uno de los 6 esperados (evita duplicados)
            if (['autenticacion', 'moviles', 'pc', 'navegacion', 'correo', 'respaldo'].includes(name)) {
                section.querySelectorAll('.checklist-item').forEach(item => {
                    const level = item.dataset.itemLevel;
                    // Prevenir la carga de datos si ya se carg√≥ una secci√≥n con ese nombre
                    if (!allChecklistData[name] || allChecklistData[name].items.length < 10) { 
                        items.push({
                            id: item.querySelector('input[type="checkbox"]').id,
                            title: item.querySelector('.item-title').textContent,
                            detail: item.querySelector('.item-detail').textContent,
                            level: level,
                            checked: false
                        });
                        totalItemsInLevel[level] = (totalItemsInLevel[level] || 0) + 1;
                    }
                });
                
                if (items.length > 0) {
                     allChecklistData[name] = { name, title, items };
                }
            }
        });

        // 1.2 Funciones de Utilidad
        function capitalize(s) {
            return s.charAt(0).toUpperCase() + s.slice(1);
        }

        // 1.3 L√≥gica de Persistencia y Actualizaci√≥n
        function updateTotals() {
            let totalChecked = 0;
            let totalTotal = 0;

            allLevels.forEach(level => checkedItemsInLevel[level] = 0);

            for (const sectionName in allChecklistData) {
                const section = allChecklistData[sectionName];
                let checkedInSection = 0;
                let totalInSection = section.items.length;

                section.items.forEach(item => {
                    if (item.checked) {
                        checkedInSection++;
                        totalChecked++;
                        checkedItemsInLevel[item.level] = (checkedItemsInLevel[item.level] || 0) + 1;
                    }
                });

                totalTotal += totalInSection;
                const score = totalInSection > 0 ? Math.round((checkedInSection / totalInSection) * 100) : 0;

                // Actualizar Tarjetas
                const scoreElement = document.getElementById(`score${capitalize(sectionName)}`);
                const checkedElement = document.getElementById(`checked${capitalize(sectionName)}`);
                const totalElement = document.getElementById(`total${capitalize(sectionName)}`);

                if (scoreElement) scoreElement.textContent = `${score}%`;
                if (checkedElement) checkedElement.textContent = checkedInSection;
                if (totalElement) totalElement.textContent = totalInSection;
            }

            // Actualizar Resumen General
            const promedioGeneral = totalTotal > 0 ? Math.round((totalChecked / totalTotal) * 100) : 0;
            document.getElementById('promedioGeneral').textContent = `${promedioGeneral}%`;
            document.getElementById('totalCheckedItems').textContent = totalChecked;
            document.getElementById('totalItems').textContent = totalTotal;
            
            updateDonutCharts();
            updateRadarChart();
            saveState(); // Guardar el estado despu√©s de cada actualizaci√≥n
        }

        // 1.4 L√≥gica de Gr√°ficos (Donut Charts)
        function updateDonutCharts() {
            const circumference = 282.7; // 2 * PI * 45 (radio)
            allLevels.forEach(level => {
                // El total se basa en los √≠tems cargados realmente
                const total = totalItemsInLevel[level] || 1; 
                const checked = checkedItemsInLevel[level] || 0;
                const percentage = Math.round((checked / total) * 100);
                const offset = circumference - (percentage / 100) * circumference;

                document.getElementById(`donutPercent${capitalize(level)}`).textContent = `${percentage}%`;
                const circle = document.getElementById(`donutCircle${capitalize(level)}`);
                if (circle) circle.style.strokeDashoffset = offset;
            });
        }

        // 1.5 L√≥gica de Gr√°ficos (Radar Chart)
        function updateRadarChart() {
            const svg = document.getElementById('cyberRadarChart');
            const data = {};
            
            for (const sectionName in allChecklistData) {
                const section = allChecklistData[sectionName];
                let checkedInSection = 0;
                let totalInSection = section.items.length;
                section.items.forEach(item => { if (item.checked) checkedInSection++; });
                data[sectionName] = totalInSection > 0 ? (checkedInSection / totalInSection) : 0;
            }

            const sections = Object.keys(data);
            const numSections = sections.length;
            if (numSections === 0) return;

            const radius = 90;
            const center = 100;
            const angleStep = (2 * Math.PI) / numSections;

            svg.innerHTML = ''; // Limpiar el SVG

            let points = "";

            // Dibujar la figura del radar (la puntuaci√≥n)
            for (let i = 0; i < numSections; i++) {
                const angle = i * angleStep - Math.PI / 2;
                const score = data[sections[i]] || 0;
                const r = radius * score;
                const x = center + r * Math.cos(angle);
                const y = center + r * Math.sin(angle);
                points += `${x},${y} `;
                
                // Dibujar l√≠neas de eje y etiquetas
                const endX = center + radius * Math.cos(angle);
                const endY = center + radius * Math.sin(angle);
                
                // L√≠nea de Eje
                const axisLine = document.createElementNS("http://www.w3.org/2000/svg", "line");
                axisLine.setAttribute('x1', center);
                axisLine.setAttribute('y1', center);
                axisLine.setAttribute('x2', endX);
                axisLine.setAttribute('y2', endY);
                axisLine.setAttribute('class', 'radar-axis');
                svg.appendChild(axisLine);
                
                // Etiqueta
                const label = document.createElementNS("http://www.w3.org/2000/svg", "text");
                // Ajustar posici√≥n para que la etiqueta no quede encima del gr√°fico
                const labelX = center + (radius * 1.1) * Math.cos(angle);
                const labelY = center + (radius * 1.1) * Math.sin(angle);

                label.setAttribute('x', labelX);
                label.setAttribute('y', labelY);
                label.setAttribute('class', 'radar-label');
                // Ajuste de anclaje de texto para centrar mejor
                label.setAttribute('text-anchor', (Math.abs(Math.cos(angle)) < 0.1) ? 'middle' : (Math.cos(angle) > 0 ? 'start' : 'end'));
                label.textContent = capitalize(sections[i]);
                svg.appendChild(label);
            }

            const polygon = document.createElementNS("http://www.w3.org/2000/svg", "polygon");
            polygon.setAttribute('points', points);
            polygon.setAttribute('class', 'radar-shape');
            svg.appendChild(polygon);
        }

        // 1.6 L√≥gica del Modal (Abre, Cierra, Guarda)
        function openModal(sectionName) {
            currentSection = sectionName;
            const modal = document.getElementById('checklistModal');
            const modalTitle = document.getElementById('modalTitle');
            const modalBody = document.getElementById('modalBody');
            
            const section = allChecklistData[sectionName];
            modalTitle.textContent = section.title;
            
            let htmlContent = '';
            let checkedCount = 0;

            section.items.forEach(item => {
                const isChecked = item.checked;
                if (isChecked) checkedCount++;
                
                htmlContent += `
                    <div class="checklist-item ${isChecked ? 'completed' : ''}" data-item-id="${item.id}">
                        <div class="checklist-row">
                            <input type="checkbox" id="modal_${item.id}" ${isChecked ? 'checked' : ''} onchange="updateModalScore('${sectionName}')">
                            <label for="modal_${item.id}" class="item-title">${item.title}</label>
                            <span class="level-tag level-${item.level}">${capitalize(item.level)}</span>
                        </div>
                        <div class="item-detail">${item.detail}</div>
                    </div>
                `;
            });

            modalBody.innerHTML = htmlContent;
            updateModalScore(sectionName, checkedCount);
            modal.style.display = 'block';
        }

        function updateModalScore(sectionName, initialCheckedCount) {
            const section = allChecklistData[sectionName];
            let checkedCount = initialCheckedCount !== undefined ? initialCheckedCount : 0;
            const total = section.items.length;
            const modalBody = document.getElementById('modalBody');
            
            if (initialCheckedCount === undefined) {
                // Si no se pasa el conteo inicial, lo calculamos en vivo desde los checkboxes del modal
                modalBody.querySelectorAll('input[type="checkbox"]').forEach(checkbox => {
                    if (checkbox.checked) checkedCount++;
                });
            }

            const score = total > 0 ? Math.round((checkedCount / total) * 100) : 0;
            document.getElementById('modalSectionScore').textContent = `${score}%`;
        }

        function saveAndCloseModal() {
            const modalBody = document.getElementById('modalBody');
            const section = allChecklistData[currentSection];

            section.items.forEach(item => {
                const checkbox = modalBody.querySelector(`#modal_${item.id}`);
                // Actualizar el estado del objeto en JS
                item.checked = checkbox.checked;
            });

            updateTotals();
            closeModal();
        }
        
        function clearCurrentSection() {
             const modalBody = document.getElementById('modalBody');
             modalBody.querySelectorAll('input[type="checkbox"]').forEach(checkbox => {
                 checkbox.checked = false;
             });
             updateModalScore(currentSection, 0); 
        }

        function closeModal() {
            document.getElementById('checklistModal').style.display = 'none';
        }
        
        // 1.7 L√≥gica de Exportaci√≥n / Impresi√≥n
        function exportarResultados() {
            // 1. Pedir el nombre de la persona
            let nombre = prompt("Por favor, introduce tu nombre para incluirlo en el reporte:");

            // Si el usuario cancela o no introduce nada, terminamos la funci√≥n
            if (!nombre) {
                return;
            }
            
            // Opcional: limpiar el nombre de espacios y limitar la longitud
            nombre = nombre.trim().substring(0, 50);

            // 2. Obtener el elemento donde mostraremos el nombre temporalmente
            const nombreElement = document.getElementById('nombrePersona');
            
            // 3. Insertar el nombre y hacerlo visible para la impresi√≥n
            nombreElement.innerHTML = `Evaluaci√≥n de Ciberseguridad de: **${nombre}**`;
            nombreElement.style.display = 'block'; // Lo hace visible

            // 4. Iniciar la impresi√≥n (esto abre el di√°logo de Imprimir/Guardar como PDF)
            window.print();

            // 5. Despu√©s de un breve retraso, ocultar el nombre de nuevo para la vista en pantalla
            setTimeout(() => {
                nombreElement.style.display = 'none';
                nombreElement.innerHTML = '';
            }, 500); // 500ms es suficiente para que se abra el di√°logo de impresi√≥n
        }


        // 1.8 Persistencia de datos con localStorage
        function loadState() {
            const savedState = localStorage.getItem('cybersecurityChecklistState');
            if (savedState) {
                const loadedData = JSON.parse(savedState);
                for (const sectionName in loadedData) {
                    if (allChecklistData[sectionName]) {
                        loadedData[sectionName].items.forEach((loadedItem) => {
                             // Usar el ID como verificaci√≥n m√°s robusta
                            const existingItem = allChecklistData[sectionName].items.find(item => item.id === loadedItem.id);
                            if (existingItem) {
                                existingItem.checked = loadedItem.checked;
                            }
                        });
                    }
                }
            }
        }

        function saveState() {
            localStorage.setItem('cybersecurityChecklistState', JSON.stringify(allChecklistData));
        }

        // Inicializaci√≥n de la aplicaci√≥n
        loadState();
        updateTotals();

    </script>
</body>
</html>
